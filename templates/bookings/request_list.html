{% extends 'base.html' %}

{% block content %}
<div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-12">
    <!-- Header Section -->
    <div class="mb-12 flex flex-col md:flex-row md:items-end justify-between gap-6 animate-fade-in">
        <div>
            <div class="brand-badge mb-4">Command Center</div>
            <h1 class="text-5xl md:text-6xl font-black text-white tracking-tighter mb-4">
                Skill <span class="text-brand-500">Exchanges</span>
            </h1>
            <p class="text-slate-400 text-lg max-w-2xl font-medium">Manage your requests and session proposals in one place.</p>
        </div>
        <div class="flex gap-4">
            <a href="{% url 'skill_list' %}" class="px-8 py-4 bg-white text-slate-900 rounded-2xl font-black hover:scale-105 transition-all shadow-xl">Browse Skills</a>
        </div>
    </div>

    <div class="grid grid-cols-1 lg:grid-cols-2 gap-12">
        <!-- Incoming Requests (For Providers) -->
        <section class="space-y-8 animate-slide-up">
            <div class="flex items-center gap-4 mb-2">
                <div class="w-12 h-12 rounded-2xl bg-brand-500/10 flex items-center justify-center text-brand-500 border border-brand-500/20">
                    <i class="fa-solid fa-inbox text-xl"></i>
                </div>
                <h2 class="text-2xl font-black text-white tracking-tight uppercase">Incoming Requests</h2>
            </div>

            {% for req in incoming_requests %}
                <div class="glass p-8 rounded-[2.5rem] border-white/5 relative overflow-hidden group hover:border-brand-500/30 transition-all duration-500">
                    <div class="flex justify-between items-start mb-6">
                        <div class="flex items-center gap-4">
                            <div class="w-14 h-14 rounded-2xl bg-slate-800 flex items-center justify-center text-slate-500 border border-white/5">
                                <i class="fa-solid fa-user-graduate text-2xl"></i>
                            </div>
                            <div>
                                <h4 class="font-black text-xl text-white">{{ req.learner.username }}</h4>
                                <p class="text-sm text-brand-500 font-bold uppercase tracking-widest">{{ req.skill.title }}</p>
                            </div>
                        </div>
                        <span class="px-4 py-1.5 rounded-full text-[10px] font-black uppercase tracking-widest 
                            {% if req.status == 'PENDING' %}bg-amber-500/10 text-amber-500 border border-amber-500/20
                            {% elif req.status == 'ACCEPTED' %}bg-green-500/10 text-green-500 border border-green-500/20
                            {% else %}bg-slate-800 text-slate-500{% endif %}">
                            {{ req.status }}
                        </span>
                    </div>

                    <div class="bg-slate-950/50 p-6 rounded-2xl border border-white/5 mb-8">
                        <p class="text-slate-300 italic">"{{ req.message }}"</p>
                    </div>

                    <div class="flex gap-4">
                        {% if req.status == 'PENDING' %}
                            <a href="{% url 'respond_request' req.id 'accept' %}" class="flex-grow flex items-center justify-center gap-2 bg-brand-600 text-white font-black py-4 rounded-xl hover:bg-brand-500 transition-all shadow-lg shadow-brand-600/20">
                                <i class="fa-solid fa-check"></i> Accept
                            </a>
                            <a href="{% url 'respond_request' req.id 'reject' %}" class="px-6 flex items-center justify-center bg-slate-800 text-slate-400 font-black py-4 rounded-xl hover:bg-red-500/20 hover:text-red-500 transition-all border border-white/5">
                                <i class="fa-solid fa-xmark"></i>
                            </a>
                        {% endif %}
                        <a href="{% url 'chat_detail' req.learner.id %}" class="px-6 flex items-center justify-center bg-slate-800 text-white font-black py-4 rounded-xl hover:bg-slate-700 transition-all border border-white/5">
                            <i class="fa-solid fa-message"></i>
                        </a>
                    </div>
                </div>
            {% empty %}
                <div class="glass p-12 rounded-[2.5rem] border-white/5 text-center opacity-40">
                    <i class="fa-solid fa-hourglass-start text-4xl mb-4 text-slate-600"></i>
                    <p class="font-bold text-slate-500 uppercase tracking-widest text-sm">No incoming requests yet</p>
                </div>
            {% endfor %}
        </section>

        <!-- Outgoing Requests (For Learners) -->
        <section class="space-y-8 animate-slide-up" style="animation-delay: 0.1s;">
            <div class="flex items-center gap-4 mb-2">
                <div class="w-12 h-12 rounded-2xl bg-blue-500/10 flex items-center justify-center text-blue-500 border border-blue-500/20">
                    <i class="fa-solid fa-paper-plane text-xl"></i>
                </div>
                <h2 class="text-2xl font-black text-white tracking-tight uppercase">Sent Proposals</h2>
            </div>

            {% for req in outgoing_requests %}
                <div class="glass p-8 rounded-[2.5rem] border-white/5 relative overflow-hidden group hover:border-blue-500/30 transition-all duration-500">
                    <div class="flex justify-between items-start mb-6">
                        <div class="flex items-center gap-4">
                            <div class="w-14 h-14 rounded-2xl bg-slate-800 flex items-center justify-center text-slate-500 border border-white/5">
                                <i class="fa-solid fa-chalkboard-user text-2xl"></i>
                            </div>
                            <div>
                                <h4 class="font-black text-xl text-white">{{ req.skill.provider.username }}</h4>
                                <p class="text-sm text-blue-500 font-bold uppercase tracking-widest">{{ req.skill.title }}</p>
                            </div>
                        </div>
                        <span class="px-4 py-1.5 rounded-full text-[10px] font-black uppercase tracking-widest 
                            {% if req.status == 'PENDING' %}bg-amber-500/10 text-amber-500 border border-amber-500/20
                            {% elif req.status == 'ACCEPTED' %}bg-green-500/10 text-green-500 border border-green-500/20
                            {% else %}bg-slate-800 text-slate-500{% endif %}">
                            {{ req.status }}
                        </span>
                    </div>

                    <p class="text-slate-400 mb-8 line-clamp-2">{{ req.message }}</p>

                    <div class="flex gap-4">
                        <a href="{% url 'skill_detail' req.skill.id %}" class="flex-grow flex items-center justify-center bg-slate-800 text-white font-black py-4 rounded-xl hover:bg-slate-700 transition-all border border-white/5">
                            View Skill
                        </a>
                        <a href="{% url 'chat_detail' req.skill.provider.id %}" class="px-6 flex items-center justify-center bg-slate-800 text-white font-black py-4 rounded-xl hover:bg-slate-700 transition-all border border-white/5">
                            <i class="fa-solid fa-message"></i>
                        </a>
                    </div>
                </div>
            {% empty %}
                <div class="glass p-12 rounded-[2.5rem] border-white/5 text-center opacity-40">
                    <i class="fa-solid fa-paper-plane text-4xl mb-4 text-slate-600"></i>
                    <p class="font-bold text-slate-500 uppercase tracking-widest text-sm">No requests sent yet</p>
                </div>
            {% endfor %}
        </section>
    </div>
</div>
{% endblock %}
